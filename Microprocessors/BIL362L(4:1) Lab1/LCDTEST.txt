LCALL INITIALIZE_LCD
MOV A,#33H
LCALL SEND_DATA
MOV A,#36H
LCALL SEND_DATA
MOV A,#32H
LCALL SEND_DATA
HERE:LJMP HERE


INITIALIZE_LCD:
; initialise the display
; see instruction set for details
CLR P1.3	
; function set	
CLR P1.7		
CLR P1.6		
SETB P1.5		
CLR P1.4		; high nibble set
SETB P1.2		
CLR P1.2		; negative edge on E
LCALL DELAY	; wait for BF to clear
SETB P1.2		 
CLR P1.2		; negative edge on E
SETB P1.7		; low nibble set 
SETB P1.2		
CLR P1.2		; negative edge on E
LCALL DELAY	; wait for BF to clear	
CLR P1.7		 
CLR P1.6		
CLR P1.5		
CLR P1.4		; high nibble set
SETB P1.2		
CLR P1.2		; negative edge on E
SETB P1.6		
SETB P1.5		; low nibble set
SETB P1.2		
CLR P1.2		; negative edge on E
LCALL DELAY	; wait for BF to clear
CLR P1.7		
CLR P1.6		
CLR P1.5		
CLR P1.4		; high nibble set
SETB P1.2		 
CLR P1.2		; negative edge on E
SETB P1.7		
SETB P1.6		
SETB P1.5		
SETB P1.4		; low nibble set
SETB P1.2	 
CLR P1.2		; negative edge on E
LCALL DELAY ; wait for BF to clear

DELAY:
PUSH 0
MOV R0, #50
DJNZ R0, $
POP 0
RET

SEND_DATA: ;send the data located at A to LCD
SETB P1.3
NOP
MOV C, ACC.7		 
MOV P1.7, C		 
MOV C, ACC.6		 
MOV P1.6, C		 
MOV C, ACC.5		
MOV P1.5, C		
MOV C, ACC.4		 
MOV P1.4, C	; high nibble set
SETB P1.2		
CLR P1.2		; negative edge on E
MOV C, ACC.3		; 
MOV P1.7, C		; 
MOV C, ACC.2		; 
MOV P1.6, C		; 
MOV C, ACC.1		; 
MOV P1.5, C		; 
MOV C, ACC.0		; 
MOV P1.4, C		; low nibble set
SETB P1.2		; 
CLR P1.2		; negative edge on E
LCALL DELAY		; wait for BF to clear
RET



